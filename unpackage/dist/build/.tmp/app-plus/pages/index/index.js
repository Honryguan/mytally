(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{1759:function(e,t,n){"use strict";n.r(t);var l=n("f159"),a=n.n(l);for(var i in l)"default"!==i&&function(e){n.d(t,e,function(){return l[e]})}(i);t["default"]=a.a},"3e04":function(e,t,n){"use strict";var l=function(){var e=this,t=e.$createElement,n=(e._self._c,e._f("dateFormat")(e.sumMonth)),l=e._f("dateFormat")(e.sumToday),a=e._f("dateFormat")(e.sumWeek),i=e._f("dateFormat")(e.sumMonth);e.$mp.data=Object.assign({},{$root:{f0:n,f1:l,f2:a,f3:i}})},a=[];n.d(t,"a",function(){return l}),n.d(t,"b",function(){return a})},afed:function(e,t,n){"use strict";n.r(t);var l=n("3e04"),a=n("1759");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n("ed4e");var s=n("2877"),u=Object(s["a"])(a["default"],l["a"],l["b"],!1,null,null,null);t["default"]=u.exports},c13d:function(e,t,n){"use strict";(function(e){n("eb38"),n("921b");l(n("66fd"));var t=l(n("afed"));function l(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},cba4:function(e,t,n){},ed4e:function(e,t,n){"use strict";var l=n("cba4"),a=n.n(l);a.a},f159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(){return Promise.all([n.e("common/vendor"),n.e("components/uni-icons/uni-icons")]).then(n.bind(null,"601a"))},a=function(){return n.e("components/uni-list/uni-list").then(n.bind(null,"ad25"))},i=function(){return n.e("components/uni-list-item/uni-list-item").then(n.bind(null,"70b3"))},s={data:function(){return{title:"SQLite",extraIcon1:{color:"#4cd964",size:"22",type:"compose"},extraIcon2:{color:"#4cd964",size:"22",type:"spinner-cycle"},extraIcon3:{color:"#4cd964",size:"22",type:"navigate"},sumToday:0,sumMonth:0,sumWeek:0,todayNote:"最近一笔 餐饮 0.00",startTodayTime:"",endTodayTime:"",month:"1",weekBetweenTime:"1月13日 - 1月19日",monthBetweenTime:"2月1日 - 2月30日",startWeekTime:"",endWeekTime:"",startMonthTime:"",endMonthTime:""}},filters:{dateFormat:function(e){return e.toFixed(2)}},components:{uniList:a,uniListItem:i,uniIcons:l},onLoad:function(){this.openDB(),this.createTables(),this.initTypesData()},onShow:function(){this.initLastToday(),this.initDataToday(),this.initIndexMouth(),this.initIndexMouthMoney(),this.initWeekBetweenTime(),this.initMonthBetweenTime(),this.initWeekSum()},methods:{initIndexMouthMoney:function(){var e=this,t=0;e.startTodayTime=e.getTodayTime(5),e.endTodayTime=e.getTodayTime(6),plus.sqlite.selectSql({name:"tally",sql:'SELECT a.id AS id,a.time AS time,a.money AS money,t.name AS typeName FROM tally a LEFT JOIN types t ON a.typeId = t.id WHERE a.time >= "'+e.startTodayTime+'" AND a.time < "'+e.endTodayTime+'";',success:function(n){for(var l in n)t+=n[l].money;e.sumMonth=t},fail:function(e){plus.nativeUI.alert("查询SQL语句失败: "+JSON.stringify(e))}})},openDB:function(){plus.sqlite.openDatabase({name:"tally",path:"_doc/tally.db",success:function(e){},fail:function(e){}})},initWeekBetweenTime:function(){var e=this,t=new Date,n=new Date,l=new Date;0==t.getDay()?n.setDate(t.getDate()-6):(n.setDate(t.getDate()-t.getDay()+1),l.setDate(t.getDate()+7-t.getDay()));var a=n.getMonth()+1,i=n.getDate();i>=1&&i<=9&&(i="0"+i),a>=1&&a<=9&&(a="0"+a);var s=l.getMonth()+1,u=l.getDate();s>=1&&s<=9&&(s="0"+s),u>=1&&u<=9&&(u="0"+u),e.weekBetweenTime=a+"月"+n.getDate()+"日 - "+s+"月"+l.getDate()+"日",e.startWeekTime=n.getFullYear()+"-"+a+"-"+i+" 00:00:00",e.endWeekTime=l.getFullYear()+"-"+s+"-"+u+" 23:59:59"},initMonthBetweenTime:function(){var e=this,t=new Date,n=new Date;t.setDate(1);t=new Date;var l=t.getMonth(),a=++l,i=new Date(t.getFullYear(),a,1),s=864e5,u=(n=new Date(i-s),t.getMonth()+1),o=n.getDate();u>=1&&u<=9&&(u="0"+u),e.monthBetweenTime=u+"月"+t.getDate()+"日 - "+u+"月"+n.getDate()+"日",e.startMonthTime=t.getFullYear()+"-"+u+"-01 00:00:00",o>=0&&o<=9&&(o="0"+o),e.endMonthTime=t.getFullYear()+"-"+u+"-"+o+" 23:59:59"},initIndexMouth:function(){var e=this,t=new Date;e.month=t.getMonth()+1},initDataToday:function(){var e=this,t=0,n=e.getTodayTime(3),l=e.getTodayTime(4);plus.sqlite.selectSql({name:"tally",sql:'SELECT a.id AS id,a.time AS time,a.money AS money,t.name AS typeName FROM tally a LEFT JOIN types t ON a.typeId = t.id WHERE a.time >= "'+n+'" AND a.time < "'+l+'" ',success:function(n){for(var l in n)t+=n[l].money;e.sumToday=t},fail:function(e){plus.nativeUI.alert("查询SQL语句失败: "+JSON.stringify(e))}})},initWeekSum:function(){var e=this,t=0;e.getTodayTime(3),e.getTodayTime(4);plus.sqlite.selectSql({name:"tally",sql:'SELECT a.id AS id,a.time AS time,a.money AS money,t.name AS typeName FROM tally a LEFT JOIN types t ON a.typeId = t.id WHERE a.time >= "'+e.startWeekTime+'" AND a.time < "'+e.endWeekTime+'" ',success:function(n){for(var l in n)t+=n[l].money;e.sumWeek=t},fail:function(e){plus.nativeUI.alert("查询SQL语句失败: "+JSON.stringify(e))}})},initLastToday:function(){var e=this;e.startTodayTime=e.getTodayTime(3),e.endTodayTime=e.getTodayTime(4),plus.sqlite.selectSql({name:"tally",sql:'SELECT a.id AS id,a.time AS time,a.money AS money,t.name AS typeName FROM tally a LEFT JOIN types t ON a.typeId = t.id WHERE a.time >= "'+e.startTodayTime+'" AND a.time < "'+e.endTodayTime+'" ORDER BY a.time DESC limit 0,1;',success:function(t){for(var n in t)e.todayNote="最近一笔 "+t[n].typeName+" "+t[n].money},fail:function(e){plus.nativeUI.alert("查询SQL语句失败: "+JSON.stringify(e))}})},existTableAccount:function(e){plus.sqlite.selectSql({name:"tally",sql:'select count(*) as count  from sqlite_master where type="table" and name = "'+e+'";',success:function(e){e.count>0&&plus.sqlite.selectSql({name:"tally",sql:"select count(*) as count  from types;",success:function(e){e.count>0||this.initTypesData()}})},fail:function(e){plus.nativeUI.alert("查询SQL语句失败: "+JSON.stringify(e))}})},initTypesData:function(){plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "其他", "2020-12-12", "contact", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "餐饮", "2020-12-12", "person", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "交通", "2020-12-12", "personadd", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "购物", "2020-12-12", "phone", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "服饰", "2020-12-12", "location", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "日用品", "2020-12-12", "email", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "娱乐", "2020-12-12", "weibo", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "食材", "2020-12-12", "chat", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "零食", "2020-12-12", "qq", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "烟酒茶", "2020-12-12", "camera", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "学习", "2020-12-12", "mic", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "医疗", "2020-12-12", "image", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "住房", "2020-12-12", "map", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "水电煤", "2020-12-12", "trash", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "通讯", "2020-12-12", "close", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "人情往来", "2020-12-12", "undo", null, null);'}),plus.sqlite.executeSql({name:"tally",sql:'INSERT INTO types VALUES (null, "设置", "2020-12-12", "star", null, null);'})},createTables:function(){plus.sqlite.executeSql({name:"tally",sql:'CREATE TABLE if not exists types ("id"  INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,"name"  TEXT,"time"  TEXT,"icon"  TEXT,"color"  TEXT,"parentId"  INTEGER);',success:function(){},fail:function(){}}),plus.sqlite.executeSql({name:"tally",sql:'CREATE TABLE if not exists tally ("id"  INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,"time"  TEXT,"typeId"  INTEGER,"money"  REAL,"remark"  TEXT,"accountId"  INTEGER);',success:function(){},fail:function(){}})},getTodayTime:function(e){var t=new Date,n=t.getFullYear(),l=t.getMonth()+1,a=t.getDate(),i=t.getHours()<10?"0"+t.getHours():t.getHours(),s=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),u=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();l>=1&&l<=9&&(l="0"+l),a>=0&&a<=9&&(a="0"+a);var o="";return 1==e?o=n+"-"+l+"-"+a+" "+i+":"+s+":"+u:2==e?o=n+"-"+l+"-"+a:3==e?o=n+"-"+l+"-"+a+" 00:00:00":4==e?o=n+"-"+l+"-"+a+" 23:59:59":5==e?o=n+"-"+l+"-00 23:59:59":6==e&&(o=n+"-"+l+"-31 23:59:59"),o},closeDB:function(){plus.sqlite.closeDatabase({name:"tally",success:function(e){plus.nativeUI.alert("关闭数据库成功")},fail:function(e){plus.nativeUI.alert("关闭数据库失败: "+JSON.stringify(e))}})},isOpenDB:function(){plus.sqlite.isOpenDatabase({name:"tally",path:"_doc/tally.db"})?plus.nativeUI.alert("Opened!"):plus.nativeUI.alert("Unopened!")}}};t.default=s}},[["c13d","common/runtime","common/vendor"]]]);